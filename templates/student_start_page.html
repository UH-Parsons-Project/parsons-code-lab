<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Exercise Analytics - Faded Parsons Problems</title>

  <link rel="stylesheet"
        href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <link rel="stylesheet"
        href="https://use.fontawesome.com/releases/v5.6.3/css/all.css">

  <link rel="stylesheet" href="/js/main.css">

</head>

<body>

  <nav class="navbar navbar-expand-md navbar-dark bg-dark sticky-top">
    <div class="navbar-brand">ðŸ§© Faded Parsons Problems</div>
		<div class="ml-auto">
			<span class="text-white">Welcome, <span id="user-name"></span>!</span>
		</div>
    <div class="ml-auto d-flex align-items-center">
      <a id="back-to-list" href="#"
         class="btn btn-outline-light btn-sm mr-3">
        Back to exercise list
      </a>
    </div>
  </nav>
  <main class="container main-nickname">
    <div class="p-4">
		<h2 class="section-title mb-3">
			In this task you will learn to make a simple loop function.
		</h2>
		<div class="text-center">
			<button id="start-btn" class="btn btn-primary btn-lg">Start</button>
		</div>
	</div>
  </main>

  <script>
    // Extract unique_link_code and task_id from URL path
    // Path: /set/{unique_link_code}/tasks/{task_id}/start
    const pathParts = window.location.pathname.split('/').filter(p => p);
    const uniqueLinkCode = pathParts[1]; // set/starter-list/tasks/1/start -> starter-list
    const taskId = pathParts[3]; // set/starter-list/tasks/1/start -> 1

    // Set the back button to return to the task list
    const backButton = document.getElementById('back-to-list');
    if (backButton) {
      backButton.href = `/set/${uniqueLinkCode}/tasks`;
    }

    // Set the start button to navigate to the task exercise
    const startBtn = document.getElementById('start-btn');
    if (startBtn) {
      startBtn.onclick = function() {
        // Save start time to localStorage
        const startTime = new Date().toISOString();
        localStorage.setItem(`task-${taskId}-start-time`, startTime);
        
        window.location.href = `/set/${uniqueLinkCode}/tasks/${taskId}`;
      };
    }
  </script>
</body>